var SenseSearchPicasso=function(){function a(){picasso.use(picassoQ),this.config()}var b=["barchart","linechart","piechart","combochart","scatterplot","kpi"];return a.prototype=Object.create(Object.prototype,{defaults:{writable:!0,value:{renderer:"canvas",valueFontSize:60,valueFontColor:"#404040",titleFontSize:20,titleFontColor:"#BBBBBB"}},options:{writable:!0,value:{}},config:{value:function(a){a=a||{};for(var b in this.defaults)this.options[b]=this.defaults[b];for(var c in a)this.options[c]=a[c];picasso.renderer["default"](this.options.renderer),"canvas"==this.options.renderer&&(this.options.titleFontSize+="px",this.options.valueFontSize+="px")}},isSupported:{value:function(a){return-1!==b.indexOf(a)}},render:{value:function(a,b){var c=this,d="render"+b.model.genericType;b.model.addListener("changed",function(){b.model.getLayout().then(function(e){c[d](a,b.model,e)})}),b.model.getLayout().then(function(e){c[d](a,b.model,e)})}},renderbarchart:{value:function(a,b,c){var d=[],e=0,f=[],g={},h={};2==c.qHyperCube.qDimensionInfo.length?(e=1,f.push({key:"main",data:{extract:{field:"qDimensionInfo/1",props:{series:{field:"qDimensionInfo/0"},end:{field:"qMeasureInfo/0"}}},stack:{stackKey:function(a){return a.value},value:function(a){return a.end.value}}}}),g={y:{data:{collection:{key:"main"}},invert:!0,expand:.2},x:{data:{extract:{field:"qDimensionInfo/1"}},padding:.3},color:{data:{extract:{field:"qDimensionInfo/0"}},type:"color"}},h={major:{scale:"x"},minor:{scale:"y",ref:"end"},box:{fill:{scale:"color",ref:"series"}}}):(f.push({key:"main",data:{extract:{field:"qDimensionInfo/0",props:{start:0,end:{field:"qMeasureInfo/0"}}}}}),g={y:{data:{extract:{field:"qMeasureInfo/0"}},invert:!0,include:[0,c.qHyperCube.qMeasureInfo[0].qMax]},x:{data:{extract:{field:"qDimensionInfo/0"}},padding:.2}},h={major:{scale:"x"},minor:{scale:"y"}});var i=picasso.chart({element:a,data:{type:"q",data:c.qHyperCube},settings:{collections:f,interactions:[{type:"native",events:{mousedown:function(a){console.log("mouse down"),this.chart.component("rangeX").emit("rangeStart",{center:{x:a.clientX,y:a.clientY},deltaX:a.movementX,deltaY:a.movementY})},mousemove:function(a){this.chart.component("rangeX").emit("rangeMove",{center:{x:a.clientX,y:a.clientY},deltaX:a.movementX,deltaY:a.movementY})},mouseup:function(a){this.chart.component("rangeX").emit("rangeEnd",{center:{x:a.clientX,y:a.clientY},deltaX:a.movementX,deltaY:a.movementY}),b.selectHyperCubeValues("/qHyperCubeDef",e,d,!0)}}}],scales:g,components:[{type:"legend-cat",dock:"right",scale:"color"},{type:"axis",dock:"left",scale:"y",settings:{}},{key:"xaxis",type:"axis",dock:"bottom",scale:"x",settings:{}},{key:"bars",type:"box",data:{collection:"main"},settings:h,brush:{consume:[{context:"range-brush",style:{inactive:{opacity:.3}}}]}},{key:"rangeX",type:"brush-range",settings:{brush:"range-brush",direction:"horizontal",scale:"x",target:{component:"xaxis"},bubbles:{align:"end"}}}]}});i.brush("range-brush").on("update",function(a){d.push(a[0].values[0])})}},renderStackedBar:{value:function(a,b,c){picasso.chart({element:a,data:{type:"q",data:c.qHyperCube},settings:{collections:[{key:"stacked",data:{extract:{field:"qDimensionInfo/1",props:{series:{field:"qDimensionInfo/0"},end:{field:"qMeasureInfo/0"}}},stack:{stackKey:function(a){return a.value},value:function(a){return a.end.value}}}}],scales:{y:{data:{collection:{key:"stacked"}},invert:!0,expand:.2},t:{data:{extract:{field:"qDimensionInfo/1"}},padding:.3},color:{data:{extract:{field:"qDimensionInfo/0"}},type:"color"}},components:[{type:"axis",dock:"left",scale:"y"},{type:"axis",dock:"bottom",scale:"t"},{type:"legend-cat",scale:"color",dock:"top"},{key:"bars",type:"box",displayOrder:1,data:{collection:"stacked"},settings:{major:{scale:"t"},minor:{scale:"y",ref:"end"},box:{fill:{scale:"color",ref:"series"}}}}]}})}},renderpiechart:{value:function(a,b,c){picasso.chart({element:a,data:{type:"q",data:c.qHyperCube},settings:{scales:{c:{data:{extract:{field:"qDimensionInfo/0"}},type:"color"}},components:[{type:"legend-cat",scale:"c"},{type:"pie",data:{extract:{field:"qDimensionInfo/0",props:{num:{field:"qMeasureInfo/0"}}}},settings:{padAngle:.01,slice:{arc:{ref:"num"},outerRadius:.8,innerRadius:.6,cornerRadius:2,opacity:1,fill:{scale:"c"},strokeWidth:1,stroke:"#ffffff"}}}]}})}},renderlinechart:{value:function(a,b,c){var d=[],e=0,f=[],g={},h={};2==c.qHyperCube.qDimensionInfo.length?(e=1,f.push({key:"main",data:{extract:{field:"qDimensionInfo/1",props:{line:{field:"qDimensionInfo/0"},end:{field:"qMeasureInfo/0"}}},stack:{stackKey:function(a){return a.value},value:function(a){return a.end.value}}}}),g={y:{data:{collection:{key:"main"}},invert:!0,expand:.2},x:{data:{extract:{field:"qDimensionInfo/1"}},padding:.3},color:{data:{extract:{field:"qDimensionInfo/0"}},type:"color"}},h={coordinates:{major:{scale:"x"},minor0:{scale:"y",ref:"start"},minor:{scale:"y",ref:"end"},layerId:{ref:"line"}},layers:{curve:"monotone",line:{show:!1},area:{fill:{scale:"color",ref:"line"}}}}):(f.push({key:"main",data:{extract:{field:"qDimensionInfo/0",props:{start:0,end:{field:"qMeasureInfo/0"}}}}}),g={y:{data:{extract:{field:"qMeasureInfo/0"}},invert:!0,include:[0,c.qHyperCube.qMeasureInfo[0].qMax]},x:{data:{extract:{field:"qDimensionInfo/0"}},padding:.2}},h={coordinates:{major:{scale:"x"},minor:{scale:"y",ref:"num"}},layers:{curve:"monotone",line:{show:!1},area:{}}});var i=picasso.chart({element:a,data:{type:"q",data:c.qHyperCube},settings:{collections:f,interactions:[{type:"native",events:{mousedown:function(a){console.log("mouse down"),this.chart.component("rangeX").emit("rangeStart",{center:{x:a.clientX,y:a.clientY},deltaX:a.movementX,deltaY:a.movementY})},mousemove:function(a){this.chart.component("rangeX").emit("rangeMove",{center:{x:a.clientX,y:a.clientY},deltaX:a.movementX,deltaY:a.movementY})},mouseup:function(a){this.chart.component("rangeX").emit("rangeEnd",{center:{x:a.clientX,y:a.clientY},deltaX:a.movementX,deltaY:a.movementY}),b.selectHyperCubeValues("/qHyperCubeDef",e,d,!0)}}}],scales:g,components:[{type:"legend-cat",dock:"right",scale:"color"},{type:"axis",dock:"left",scale:"y",settings:{}},{key:"xaxis",type:"axis",dock:"bottom",scale:"x",settings:{}},{key:"lines",type:"line",data:{collection:"main"},settings:h},{key:"rangeX",type:"brush-range",settings:{brush:"range-brush",direction:"horizontal",scale:"x",target:{component:"xaxis"},bubbles:{align:"end"}}}]}});i.brush("range-brush").on("update",function(a){d.push(a[0].values[0])})}},rendercombochart:{value:function(a,b,c){picasso.chart({element:a,data:{type:"q",data:c.qHyperCube},settings:{scales:{y:{data:{extract:{field:"qMeasureInfo/0"}},invert:!0,include:[0,c.qHyperCube.qMeasureInfo[0].qMax]},y2:{data:{extract:{field:"qMeasureInfo/1"}},invert:!0,include:[0,c.qHyperCube.qMeasureInfo[1].qMax]},x:{data:{extract:{field:"qDimensionInfo/0"}},padding:.2}},components:[{type:"axis",dock:"left",scale:"y",settings:{}},{type:"axis",dock:"right",scale:"y2",settings:{}},{type:"axis",dock:"bottom",scale:"x",settings:{}},{key:"bars",type:"box",data:{extract:{field:"qDimensionInfo/0",props:{start:0,end:{field:"qMeasureInfo/0"}}}},settings:{major:{scale:"x"},minor:{scale:"y"}}},{key:"line",type:"line",data:{extract:{field:"qDimensionInfo/0",props:{num:{field:"qMeasureInfo/1"}}}},settings:{coordinates:{major:{scale:"x"},minor:{scale:"y2",ref:"num"}},layers:{curve:"monotone",line:{stroke:"#b53f3f"}}}}]}})}},renderscatterplot:{value:function(a,b,c){picasso.chart({element:a,data:{type:"q",data:c.qHyperCube},settings:{scales:{s:{data:{extract:{field:"qMeasureInfo/0"}},expand:.2,invert:!0},m:{data:{extract:{field:"qMeasureInfo/1"}},expand:.1},col:{data:{extract:{field:"qDimensionInfo/0"}},type:"color"}},components:[{key:"y-axis",type:"axis",scale:"s",dock:"left"},{type:"legend-cat",dock:"right",scale:"col"},{key:"x-axis",type:"axis",scale:"m",dock:"bottom"},{key:"p",type:"point",data:{extract:{field:"qDimensionInfo/0",props:{y:{field:"qMeasureInfo/0"},x:{field:"qMeasureInfo/1"}}}},settings:{x:{scale:"m"},y:{scale:"s"},shape:"circle",size:1,strokeWidth:2,stroke:"#fff",opacity:.8}}]}})}},renderkpi:{value:function(a,b,c){var d,e;c.qHyperCube.qMeasureInfo&&c.qHyperCube.qMeasureInfo[0]&&(d=c.qHyperCube.qMeasureInfo[0].qFallbackTitle,e=c.qHyperCube.qDataPages[0].qMatrix[0][0].qText,picasso.chart({element:a,settings:{components:[{type:"text",text:e,dock:"top",style:{text:{fontSize:this.options.valueFontSize,fill:this.options.valueFontColor}},settings:{anchor:"center",paddingStart:20,paddingEnd:50}},{type:"text",text:d,dock:"top",style:{text:{fontSize:this.options.titleFontSize,fill:this.options.titleFontColor}},settings:{anchor:"center",paddingStart:20,paddingEnd:20}}]}}))}}}),a}();window.senseSearchPicasso=new SenseSearchPicasso;